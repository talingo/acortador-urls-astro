async function R(n,t,o){const{callbackUrl:a=window.location.href,redirect:s=!0}=t??{},{prefix:c="/api/auth",...i}=t??{},e=n==="credentials",w=e||n==="email",d=`${`${c}/${e?"callback":"signin"}/${n}`}?${new URLSearchParams(o)}`,u=await fetch(`${c}/csrf`),{csrfToken:f}=await u.json(),l=await fetch(d,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...i,csrfToken:f,callbackUrl:a})}),r=await l.clone().json(),h=new URL(r.url).searchParams.get("error");if(s||!w||!h){window.location.href=r.url??a,r.url.includes("#")&&window.location.reload();return}return l}async function g(n){const{callbackUrl:t=window.location.href,prefix:o="/api/auth"}=n??{},a=await fetch(`${o}/csrf`),{csrfToken:s}=await a.json(),e=(await(await fetch(`${o}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:s,callbackUrl:t})})).json()).url??t;window.location.href=e,e.includes("#")&&window.location.reload()}export{R as signIn,g as signOut};
